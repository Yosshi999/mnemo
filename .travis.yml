language: node_js
node_js:
  - node
script:
  - npm run build
after_success:
  - git config remote.origin.fetch "+refs/heads/*:refs/remotes/origin/*"
  - git fetch --unshallow
  - git config user.name "Travis CI"
  - git config user.email "hakatasiloving@gmail.com"
  - git clean -fd
  - git checkout -- .
  - git checkout gh-pages
  - git checkout master .
  - npm run build
  - ls -lah
  - git add --all
  - git commit -m "Update build"
  - git push "https://${GH_TOKEN}@github.com/tsg-ut/mnemo.git" gh-pages:gh-pages --follow-tags > /dev/null 2>&1
branches:
  except:
    - /^v\d+\.\d+\.\d+$/
    - gh-pages
notifications:
  webhooks: http://webhook.hakatashi.com/travis
